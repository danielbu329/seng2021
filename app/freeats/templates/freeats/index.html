{% load staticfiles %}

<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css"
      href="{% static 'freeats/css/bootstrap-3.3.5/bootstrap.min.css' %}">
    <link rel="stylesheet" type="text/css"
      href="{% static 'freeats/css/style.css' %}" />
    <link rel="stylesheet" type="text/css"
      href="{% static 'freeats/css/responsive-style.css' %}" />
    <script type="text/javascript" data-main="{% static 'freeats/js/main.js' %}"
      src="{% static 'freeats/js/lib/require-2.1.20.min.js' %}"></script>
  </head>
  <body ng-controller="MainCtrl">
    <div class="map"></div>
    <div class="mobile-top-bar"></div>
    <div class="item-panel">
      <div class="indent freeats-title">
        <img src="{% static 'freeats/logo_side.png' %}">
      </div>
      <div class="indent items">
        <div class="mobile-back-button" ng-click="mobileBackButton()">
          <span class="glyphicon glyphicon-circle-arrow-left" aria-hidden="true"</span>
        </div>
        <div ng-repeat="item in foodCollection">
          <div class="item" ng-click="showFoodOnMap($event, item.id)">
            <div class="letter">
              <span class="middle" ng-bind="item.letter"></span>
            </div>
            <div class="title">
              <span class="middle" ng-bind="item.title"></span>
              <div class="info-btn middle pull-right"
                    ng-click="showFoodDetail($event, item.id)">
                <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
              </div>
            </div>
            <div class="voteBtn up" ng-class="{'selected': item.vote == 'up'}"
                  ng-click="upvote($event, item.id)">
              <span class="glyphicon glyphicon-chevron-up" aria-hidden="true"></span>
            </div>
            <div class="location">
              <span class="middle" ng-bind="item.location"></span>
            </div>
            <div class="voteBtn down" ng-class="{'selected': item.vote == 'down'}"
                  ng-click="downvote($event, item.id)">
              <span class="glyphicon glyphicon-chevron-down" aria-hidden="true"></span>
            </div>
            <div class="bar">
              <span class="upvotes" ng-style="{ 'width': item.upvotes }">&nbsp;</span>
              <span class="downvotes" ng-style="{ 'width': item.downvotes }">&nbsp;</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="top-right">
      <div class="dropdown">
        <img src="{% static 'freeats/profile.jpg' %}"
              id="userDropdown" data-toggle="dropdown">
        <ul class="dropdown-menu pull-right" aria-labelledby="userDropdown">
          <li><a href="#">My Posts</a></li>
          <li><a href="#">Settings</a></li>
          <li><a href="#">Logout</a></li>
        </ul>
      </div>
    </div>

    <div class="bottom-right">
      <button type="button" class="btn btn-danger" ng-click="createPost()">
        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
        <span class="text">New post</span>
      </button>
    </div>

    <!-- Modal popups below -->

    <div id="foodDetailModal" class="modal fade">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close"
              data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <h4 class="modal-title">
              <span ng-bind="currentItem.title"></span>
            </h4>
          </div>
          <div class="modal-body">
            <div class="voteBtn-group pull-right">
              <div class="voteBtn up"
                    ng-class="{'selected': currentItem.vote == 'up'}"
                    ng-click="upvote($event, currentItem.id)">
                <span class="glyphicon glyphicon-chevron-up" aria-hidden="true"></span>
              </div>
              <div class="voteBtn down"
                    ng-class="{'selected': currentItem.vote == 'down'}"
                    ng-click="downvote($event, currentItem.id)">
                <span class="glyphicon glyphicon-chevron-down" aria-hidden="true"></span>
              </div>
            </div>
            <p>
              <b>Where:</b> <span ng-bind="currentItem.location"></span>
            </p>
            <p>
              <b>Original Post:</b>
              <br/>
              <img ng-if="currentItem.pic" src="{% static 'freeats/pizza.jpg' %}"
                  class="food-pic pull-right">
            </p>
            <blockquote class="food-post">
              <p ng-bind="currentItem.post"></p>
              <div ng-if="currentItem.fromFacebook">
                <footer>UNSW Free Food Facebook group</footer>
              </div>
            </blockquote>
          </div>
          <div class="modal-footer">
            <span class="pull-left modal-footer-info">
              <div ng-switch on="currentItem.fromFacebook">
                <div ng-switch-when="true">
                  <a target="_blank"
                      href="https://www.facebook.com/groups/unswfreefood">
                    <img src="{% static 'freeats/fb_icon.png' %}" class="fb-icon">
                  </a>
                  <a target="_blank"
                      href="https://www.facebook.com/groups/unswfreefood">
                    See this post on Facebook
                  </a>
                </div>
                <div ng-switch-default>
                  Submitted via Freeats
                </div>
              </div>
            </span>
            <button type="button" class="btn btn-default"
              data-dismiss="modal">
                Close
            </button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

    <div id="newPostModal" class="modal fade">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close"
              data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <h4 class="modal-title">Create Post</h4>
          </div>
          <form class="form-horizontal" role="form">
            <div class="modal-body">
              <div class="form-group">
                <label class="control-label col-sm-3" for="title">Title:</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" id="title">
                </div>
              </div>
              <div class="form-group">
                <label class="control-label col-sm-3" for="location">Location:</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" id="location">
                </div>
              </div>
              <div class="form-group">
                <label class="control-label col-sm-3" for="description">Description:</label>
                <div class="col-sm-9">
                  <textarea class="form-control" rows="5" id="description"></textarea>
                </div>
              </div>
              <div class="form-group">
                <label class="control-label col-sm-3" for="image-upload">Upload Image:</label>
                <div class="col-sm-9">
                  <input type="file" id="image-upload">
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default"
                data-dismiss="modal">
                  Close
              </button>
              <button type="submit" class="btn btn-primary pull-right">
                Submit post
              </button>
            </div>
          </form>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

  </body>
</html>
